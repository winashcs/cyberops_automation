import random
import pyautogui

# Disable failsafe to prevent accidental termination of script
pyautogui.FAILSAFE = False

# Ask user for number of iterations
try:
    num_iterations = int(input("Enter the number of iterations: "))
except ValueError:
    print("Invalid input. Defaulting to 1 iteration.")
    num_iterations = 1

# Perform random clicks and minimize windows
for _ in range(num_iterations):
    # Generate random coordinates within screen resolution
    h = random.randint(0, 1080)
    w = random.randint(0, 1920)

    # Perform a click at the random coordinates
    pyautogui.click(w, h, duration=0.3)

    # Minimize all windows using the Windows key + M
    pyautogui.hotkey('winleft', 'm')
